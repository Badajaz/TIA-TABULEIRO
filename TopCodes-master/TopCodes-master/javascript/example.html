<!DOCTYPE html>
<html>
<head>
  <title>TopCodes Example</title>
</head>

<body>
  <canvas id="video-canvas" width="1200" height="500" style="background: #ddd;"></canvas>
  <br/>
  <button id="camera-button" onclick="TopCodes.startStopVideoScan('video-canvas')">Start / Stop</button>

  <script src="topcodes.js"></script>
  
  <p id="demo"></p>
  <p id="demo2"></p>

  <script>

  TopCodes.setVideoFrameCallback("video-canvas", function(jsonString) {
    var json = JSON.parse(jsonString);
	//console.log(json);
	var arrayTopcodes = json.topcodes;
	drawCodes(json.topcodes);
	document.getElementById("demo2").innerHTML =  jsonString;
	var codes = arrayTopcodes.map(function(item) {
		var dimensoes = [];
		 
 		 if(item.code == 31 || item.code == 205){
			dimensoes+=[item.code,item.x,item.y];
		 }
		
		 
		
		return dimensoes[1]-dimensoes[4];
	});
/*
	var dim = arrayTopcodes.map(function(item) {
		 var dimensoes31 = {};
		 var dimensoes205 = {};
		 
 		 if(item.code == 31){
			dimensoes31 ={item.code,item.x,item.y};
		}
		
		if(| item.code == 205){
			dimensoes205 ={item.code,item.x,item.y};
		}
		
		return dimensoes31[1]-dimensoes205[1];
	});*/
	
	document.getElementById("demo").innerHTML =  codes;
	//zdocument.getElementById("demo2").innerHTML =  dim;
	
	
	

	
});


  function drawCodes(topcodes) {
    var ctx = document.querySelector("#video-canvas").getContext('2d');
    ctx.fillStyle = "rgba(255, 0, 0, 0.3)";
    for (i=0; i<topcodes.length; i++) {
      ctx.beginPath();
      ctx.arc(topcodes[i].x, topcodes[i].y, topcodes[i].radius, 0, Math.PI*2, true);
      ctx.fill();
    }
  }

  </script>
</body>
</html>
